- name: Publicar Modulo
  shell: pwsh
  env:
    PSG_KEY: ${{ secrets.PSGALLERY_API_KEY }}
  run: |
    $ErrorActionPreference = "Stop"

    Write-Host "==== INICIANDO PUBLICAÇÃO DO MÓDULO ===="

    # 1️⃣ Validação do Secret
    if ([string]::IsNullOrWhiteSpace($env:PSG_KEY)) {
        throw "ERRO: PSG_KEY está vazia. Configure corretamente o Secret PSGALLERY_API_KEY."
    }

    # 2️⃣ Validar existência da pasta do módulo
    $modulePath = "./src/PoshAutomator"

    if (-not (Test-Path $modulePath)) {
        throw "ERRO: Caminho $modulePath não encontrado."
    }

    # 3️⃣ Validar existência do manifesto (.psd1)
    $ma
